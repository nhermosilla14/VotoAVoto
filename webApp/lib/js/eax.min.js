/*
 * The MIT License
 *
 * (MIT)Copyright (c) 2015 artjomb
 */
!function(t){var r;r=t.hasOwnProperty("ext")?t.ext:t.ext={},r.bitshift=function(t,r){var e,n,i=0,s=t.words,o=0;if(r>0){for(;r>31;)s.splice(0,1),s.push(0),r-=32,o++;if(0==r)return i;for(var a=s.length-o-1;a>=0;a--)e=s[a],s[a]<<=r,s[a]|=i,i=e>>>32-r}else if(0>r){for(;-31>r;)s.splice(0,0,0),s.length--,r+=32,o++;if(0==r)return i;r=-r,n=(1<<r)-1;for(var a=o;a<s.length;a++)e=s[a]&n,s[a]>>>=r,s[a]|=i,i=e<<32-r}return i},r.neg=function(t){for(var r=t.words,e=0;e<r.length;e++)r[e]=~r[e];return t},r.xor=function(t,r){for(var e=0;e<t.words.length;e++)t.words[e]^=r.words[e];return t},r.bitand=function(t,r){for(var e=t.clone(),n=e.words,i=r.words,s=0;s<n.length;s++)n[s]&=i[s];return e}}(CryptoJS),function(t){var r;r=t.hasOwnProperty("ext")?t.ext:t.ext={};{var e=(t.lib.Base,t.lib.WordArray);t.algo.AES}r.const_Zero=e.create([0,0,0,0]),r.const_One=e.create([0,0,0,1]),r.const_Rb=e.create([0,0,0,135]),r.const_Rb_Shifted=e.create([2147483648,0,0,67]),r.const_nonMSB=e.create([4294967295,4294967295,2147483647,2147483647]),r.isWordArray=function(t){return t&&"function"==typeof t.clamp&&"function"==typeof t.concat&&"array"==typeof t.words},t.pad.OneZeroPadding={pad:function(t,r){for(var n=4*r,i=n-t.sigBytes%n,s=[],o=0;i>o;o+=4){var a=0;0===o&&(a=2147483648),s.push(a)}var c=e.create(s,i);t.concat(c)},unpad:function(){}},t.pad.NoPadding={pad:function(){},unpad:function(){}},r.leftmostBytes=function(t,r){var e=t.clone();return e.sigBytes=r,e.clamp(),e},r.rightmostBytes=function(t,e){t.clamp();var n=32,i=t.clone(),s=8*(i.sigBytes-e);if(s>=n){var o=Math.floor(s/n);s-=o*n,i.words.splice(0,o),i.sigBytes-=o*n/8}return s>0&&(r.bitshift(i,s),i.sigBytes-=s/8),i},r.popWords=function(t,e){var n=r.leftmostBytes(t,4*e);return t.words=t.words.slice(e),t.sigBytes-=4*e,n},r.shiftBytes=function(t,n){n=n||16;var i=n%4;n-=i;for(var s=e.create(),o=0;n>o;o+=4)s.words.push(t.words.shift()),t.sigBytes-=4,s.sigBytes+=4;return i>0&&(s.words.push(t.words[0]),s.sigBytes+=i,r.bitshift(t,8*i),t.sigBytes-=i),s},r.xorendBytes=function(t,e){return r.leftmostBytes(t,t.sigBytes-e.sigBytes).concat(r.xor(r.rightmostBytes(t,e.sigBytes),e))},r.dbl=function(t){var e=r.msb(t);return r.bitshift(t,1),r.xor(t,1===e?r.const_Rb:r.const_Zero),t},r.inv=function(t){var e=1&t.words[4];return r.bitshift(t,-1),r.xor(t,1===e?r.const_Rb_Shifted:r.const_Zero),t},r.equals=function(t,r){if(!r||!r.words||t.sigBytes!==r.sigBytes)return!1;t.clamp(),r.clamp();for(var e=0,n=0;n<t.words.length;n++)e|=t.words[n]^r.words[n];return 0===e},r.msb=function(t){return t.words[0]>>>31}}(CryptoJS),function(t){function r(r,e){var s=i.createEncryptor(r,{iv:n.create(),padding:t.pad.NoPadding}),o=s.finalize(e);return o}var e=t.lib.Base,n=t.lib.WordArray,i=t.algo.AES,s=t.ext,o=t.pad.OneZeroPadding,a=t.algo.CMAC=e.extend({init:function(t){var e=r(t,s.const_Zero),n=e.clone();if(s.dbl(n),this._isTwo){var i=e.clone();s.inv(i)}else{var i=n.clone();s.dbl(i)}this._K1=n,this._K2=i,this._K=t,this._const_Bsize=16,this.reset()},reset:function(){this._x=s.const_Zero.clone(),this._counter=0,this._buffer=n.create()},update:function(e){if(!e)return this;var n=this._buffer,i=this._const_Bsize;for("string"==typeof e&&(e=t.enc.Utf8.parse(e)),n.concat(e);n.sigBytes>i;){var o=s.shiftBytes(n,i);s.xor(this._x,o),this._x.clamp(),this._x=r(this._K,this._x),this._counter++}return this},finalize:function(t){this.update(t);var e=this._buffer,n=this._const_Bsize,i=e.clone();return e.sigBytes===n?s.xor(i,this._K1):(o.pad(i,n/4),s.xor(i,this._K2)),s.xor(i,this._x),this.reset(),r(this._K,i)},_isTwo:!1});t.CMAC=function(t,r){return a.create(t).finalize(r)},t.algo.OMAC1=a,t.algo.OMAC2=a.extend({_isTwo:!0})}(CryptoJS),function(t){{var r=t.lib.Base,e=t.lib.WordArray,n=t.algo.AES,i=t.ext,s=t.algo.CMAC,o=e.create([0,0,0,0]),a=e.create([0,0,0,1]),c=e.create([0,0,0,2]),f=16;t.EAX=r.extend({init:function(t,r){var e;if(r&&r.splitKey){var n=Math.floor(t.sigBytes/2);e=i.shiftBytes(t,n)}else e=t.clone();this._ctrKey=t,this._mac=s.create(e),this._tagLen=r&&r.tagLength||f,this.reset()},reset:function(){this._mac.update(a),this._ctr&&this._ctr.reset()},updateAAD:function(t){return this._mac.update(t),this},initCrypt:function(r,s){var a=this;return a._tag=a._mac.finalize(),a._isEnc=r,a._mac.update(o),s=a._mac.finalize(s),i.xor(a._tag,s),a._ctr=n.createEncryptor(a._ctrKey,{iv:s,mode:t.mode.CTR,padding:t.pad.NoPadding}),a._buf=e.create(),a._mac.update(c),a},update:function(r){"string"==typeof r&&(r=t.enc.Utf8.parse(r));var n=this,s=n._buf,o=n._isEnc;s.concat(r);var a=o?s.sigBytes:Math.max(s.sigBytes-n._tagLen,0),c=a>0?i.shiftBytes(s,a):e.create(),f=n._ctr.process(c);return n._mac.update(o?f:c),f},finalize:function(t){var r=this,n=t?r.update(t):e.create(),s=r._mac,o=r._ctr.finalize();if(r._isEnc){var a=s.finalize(o);return i.xor(r._tag,a),r.reset(),n.concat(o).concat(r._tag)}var a=s.finalize();return i.xor(r._tag,a),r.reset(),i.equals(r._tag,r._buf)?n.concat(o):!1},encrypt:function(t,r,e){var n=this;return e&&Array.prototype.forEach.call(e,function(t){n.updateAAD(t)}),n.initCrypt(!0,r),n.finalize(t)},decrypt:function(t,r,e){var n=this;return e&&Array.prototype.forEach.call(e,function(t){n.updateAAD(t)}),n.initCrypt(!1,r),n.finalize(t)}})}}(CryptoJS);